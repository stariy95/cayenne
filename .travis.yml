# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements. See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to You under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License. You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# Since 4GB is not enough for the build, we use 'sudo' environment with 7.5GB RAM
# Downside: It's starts a little bit slower
# How to fix: Change build setting or fix code.
# https://docs.travis-ci.com/user/ci-environment/#Virtualization-environments
sudo: required
group: precise # needed for jdk 7

before_install:
  - if [ "${TRAVIS_JDK_VERSION}" == "oraclejdk7" ]; then export JAVA_HOME="/usr/lib/jvm/java-7-oracle"; export PATH="${JAVA_HOME}/bin:${PATH}"; fi
  - test "${TRAVIS_JDK_VERSION}" != "oraclejdk7" || (test ! -d "${JAVA_HOME}" && (curl http://ftp.osuosl.org/pub/funtoo/distfiles/oracle-java/jdk-7u80-linux-x64.tar.gz | sudo tar xz -C /usr/lib/jvm; sudo mv /usr/lib/jvm/jdk1.7.0_80 "${JAVA_HOME}"))

script:
  - java -version
#
#services:
#  - docker
#
#language: java
#
#env:
#  - DB_PROFILE=hsql
#  - DB_PROFILE=h2
#  - DB_PROFILE=derby
#  - DB_PROFILE=mysql-docker
#  - DB_PROFILE=postgres-docker
#  - DB_PROFILE=sqlserver-docker
#
#jdk:
#  - oraclejdk7 # disable jdk7 as travis seems drop support for it
#  - openjdk8
#  - openjdk11
#
#script:
#  - travis_wait 30 mvn verify -q -DcayenneTestConnection=$DB_PROFILE -DcayenneLogLevel=ERROR
#
## prevent Travis from unneeded "mvn install" run
#install: true

#cache:
#  directories:
#    - $HOME/.m2
